# 암호화 키 생성 빠른 가이드

**상황**: 서버에 OpenSSL 또는 PHP CLI가 없는 경우  
**해결**: 로컬 개발 환경에서 키 생성 후 서버에 전송

---

## 🚀 빠른 해결 방법

### 1단계: 로컬에서 키 생성

**Mac/Linux 로컬 개발 환경:**
```bash
openssl rand -hex 32
```

**출력 예시:**
```
a1b2c3d4e5f6789012345678901234567890123456789012345678901234567890
```

**Windows 로컬 개발 환경 (Git Bash 또는 WSL):**
```bash
openssl rand -hex 32
```

**또는 PHP가 로컬에 있다면:**
```bash
php -r "echo bin2hex(random_bytes(32));"
```

---

### 2단계: 생성된 키를 서버에 전송

#### 방법 1: 직접 입력 (가장 안전)

1. 생성된 키를 복사 (64자리 hex 문자열)

2. 서버에 접속:
   ```bash
   ssh pci0327@uws8-wpm-079
   cd /path/to/www
   ```

3. `.env` 파일 생성:
   ```bash
   vi .env
   # 또는
   nano .env
   ```

4. 파일 내용 입력:
   ```bash
   JUMIN_ENCRYPTION_KEY=a1b2c3d4e5f6789012345678901234567890123456789012345678901234567890
   ```
   (위 `a1b2c3...` 부분을 생성한 키로 교체)

5. 저장 및 종료:
   - vi: `ESC` → `:wq` → `Enter`
   - nano: `Ctrl+O` → `Enter` → `Ctrl+X`

6. 파일 권한 설정:
   ```bash
   chmod 600 .env
   ```

#### 방법 2: 한 줄 명령어로 전송 (로컬에서 실행)

```bash
# 로컬에서 키 생성 및 서버로 전송
KEY=$(openssl rand -hex 32)
echo "JUMIN_ENCRYPTION_KEY=$KEY" | ssh pci0327@uws8-wpm-079 "cat > /path/to/www/.env && chmod 600 /path/to/www/.env"

# 확인
ssh pci0327@uws8-wpm-079 "cat /path/to/www/.env"
```

---

### 3단계: 확인

서버에서 확인:
```bash
# 파일 존재 확인
ls -la /path/to/www/.env

# 파일 권한 확인 (600이어야 함)
stat -c "%a %n" /path/to/www/.env

# 내용 확인 (키 값만 표시)
grep JUMIN_ENCRYPTION_KEY /path/to/www/.env | cut -d'=' -f2 | wc -c
# 출력: 65 (64자 + 줄바꿈)
```

---

## ⚠️ 주의사항

1. **키 백업**: 생성된 키를 안전한 곳에 백업하세요.
2. **키 공유 금지**: 키를 절대 Git에 커밋하거나 공유하지 마세요.
3. **파일 권한**: `.env` 파일은 600 권한으로 설정하세요.
4. **운영/개발 분리**: 운영 환경과 개발 환경은 다른 키를 사용하세요.

---

## 🔧 문제 해결

### Q: 서버에 접속할 수 없나요?
A: 로컬에서 키를 생성하고, 서버 관리자에게 `.env` 파일 생성 요청을 하세요.

### Q: 키 형식이 맞나요?
A: 키는 정확히 64자리 16진수 문자열이어야 합니다 (0-9, a-f).

### Q: 키를 잃어버렸나요?
A: 새 키를 생성한 후 기존 데이터를 재암호화해야 합니다. 별도 계획이 필요합니다.

---

**작성일**: 2026-01-14  
**최종 업데이트**: 2026-01-14
